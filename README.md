This is the python code that I use to generate some plots in the paper that I am currently working on. Basically, it can generate any order of discrete nonlocal kernel based on material's microstructure of a 1-D elastic composite rod. I generate the nonlocal kernels of different orders in a systematic way. However, when order gets higher, the numerical errors seems to be amplified exponentially which will make the matrix inside the lineq_solver in [nonlocal_kernel](nonlocal_kernel.ipynb) to be nearly singular.  This limits that, right now, the highest order of the nonlocal kernel that the code can generate accurately is only 6.

Finally we compare the numerical result calculated using different order of nonlocal kernel with the classical peridynamic kernel as well as the "accurate" result by using FEM with extremely fine mesh. It shows that the nonlocal kernel it generates is much more accurate than classical peridynamic kernel when simulating the composite rod with heterogeneous microstructure.

Notice that this is the code that I use for some numerical testing and plots. So it is not robust right now. But it is promising that this code can be developed further if all the numerical problems have been solved. 
